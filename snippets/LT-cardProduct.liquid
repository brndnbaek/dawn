{% comment %}
    Renders a product card

    Accepts:
    - card_product: {Object} Product Liquid object (optional)
    - media_aspect_ratio: {String} Size of the product image card. Values are "square" and "portrait". Default is "square" (optional)
    - show_secondary_image: {Boolean} Show the secondary image on hover. Default: false (optional)
    - show_vendor: {Boolean} Show the product vendor. Default: false
    - show_rating: {Boolean} Show the product rating. Default: false
    - extend_height: {Boolean} Card height extends to available container space. Default: true (optional)
    - lazy_load: {Boolean} Image should be lazy loaded. Default: true (optional)

    Usage:
    {% render 'card-product', show_vendor: section.settings.show_vendor %}
{% endcomment %}
{% assign my_meta = card_product.metafields.my_fields %}    

<div class="relative w-full ml-10 md:ml-[3rem] h-full mt-3 md:mt-[2rem] bg-rose-50/30 rounded-lg group outline outline-1 outline-neutral-400 grow-0 shrink-0" >
  {% assign image_def = card_product.featured_media.aspect_ratio %}
  {% if image_def > 1.2 %}
  <a href="{{card_product.url}}" class="no-underline text-neutral-800">
    <img src="{{card_product.featured_media | img_url: 'x350'}}" alt="" class="absolute object-cover w-[250px] md:w-[19rem] h-auto duration-300  rounded-lg top-4 -left-8 md:top-[1.5rem] md:-left-[1.5rem] drop-shadow-lg outline-1 outline outline-slate-500 group-hover:scale-110 transition"></a>
  {% elsif image_def < 0.85 %}
  <a href="{{card_product.url}}" class="no-underline text-neutral-800">
    <img src="{{card_product.featured_media | img_url: 'x350'}}" alt="" class="absolute object-cover h-[90%] max-h-[80%] md:max-h-[18rem] -top-[1rem] md:-top-[1.5rem] left-16  md:left-[2rem] max-w-1/2 md:max-w-[18rem] rounded-lg top-0 drop-shadow-lg outline-1 outline outline-slate-500 group-hover:scale-110 duration-300"></a>
  {% else %}
  <a href="{{card_product.url}}" class="no-underline text-neutral-800">
    <img src="{{card_product.featured_media | img_url: 'x350'}}" alt="" class="absolute object-cover w-[200px] md:w-[60%] rounded-lg -top-[1.5rem] -left-[1.5rem] h-auto outline-1 outline outline-slate-500 group-hover:scale-110 duration-300"></a>
  {%endif%}
  <!-- Title box absolute location and style per image ratio  -->
  {%if card_product.tags contains 'model kit' %}
  <div class="flex flex-col items-center justify-end w-full h-full p-6 ">
    <div class="text-center  mx-auto text-xl leading-tight break-words  h-[3rem] group-hover:text-indigo-800 group-hover:font-normal relative">
      <a href="{{card_product.url}}" class="no-underline text-neutral-800">
        {{card_product.title | escape | remove_first:my_meta.grade| remove_first:my_meta.brand |remove_first:my_meta.series|remove_first:my_meta.size}}
      
      <div class="absolute inset-0 w-full h-full bg-indigo-200 opacity-40 filter rounded-xl blur-lg"> </div></a>
    </div>
  </div>
  
  {%elsif image_def < 0.8 %}
  <div class="flex flex-col items-center justify-end w-full h-full p-6">
    <div class="text-center  mx-auto text-xl leading-tight break-words text-neutral-800 h-[3rem] relative">
      <a href="{{card_product.url}}" class="no-underline text-neutral-800">{{card_product.title | escape |remove:'K-Pop CD'|remove:'K-pop CD'}}
      <div class="absolute inset-0 w-full h-full bg-indigo-200 opacity-40 filter rounded-xl blur-lg"> </div></a>
    </div>
  </div>
  {%else %}
  <div class="flex flex-col items-center justify-end w-full h-full p-6">
    <div class="text-center  mx-auto text-xl leading-tight break-words text-neutral-800 h-[3rem] relative ">
      <a href="{{card_product.url}}" class="no-underline text-neutral-800">{{card_product.title | escape |remove:'K-Pop CD'|remove:'K-pop CD'}}
      <div class="absolute inset-0 w-full h-full bg-indigo-200 opacity-40 filter rounded-xl blur-lg -z-0"> </div>
    </a>
    </div>
  </div>
  {%endif%}


  <!-- whole block linkable trick -->
  <!-- <a href="{{card_product.url}}"><span class="absolute top-0 left-0 z-10 w-1/2 h-full"></span></a> -->
  
  <!-- pricing box  -->
  <div class="absolute top-[60%] right-[1.25rem] rounded-lg px-2 py-1 shadow-lg {%if card_product.available %} bg-lt-apricot/80{%else%} bg-neutral-500{%endif%}">
    <a href="{{card_product.url}}" class="{%if card_product.available%}no-underline {%else%}line-through text-gray-500{%endif%}">
      {% render 'LTprice2', product: card_product, price_class: 'text-center text-neutral-100 text-2xl' %}
    </a>
    
    
    
  </div>
  
  <!-- top-right sub description box -->
  <div class="absolute top-0 w-1/3 right-1">
    <ul class="flex flex-col items-end w-full break-words list-none">
      
      <!-- conditional list to show artist link either collection or by searh -->
      {% capture artist %}{{my_meta.artist | handle}}{%endcapture%}
      {%if collections[artist].products.size != 0 %}
      <a href="/collections/{{artist}}" class="text-gray-800 no-underline">
        <li class="flex items-baseline justify-between gap-1 text-base empty:hidden ">{{card_product.metafields.my_fields.artist}}
          <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
            <path stroke-linecap="round" stroke-linejoin="round" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14" />
          </svg>
        </li>
      </a>
      {%elsif my_meta.artist %}
      <a href="/search?q={{artist}}" class="no-underline">
        <li class="flex items-baseline justify-between gap-1 text-base empty:hidden ">
          {{card_product.metafields.my_fields.artist}}
          <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
            <path stroke-linecap="round" stroke-linejoin="round" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14" />
          </svg>
        </li>
      </a>
      {%endif%}

      <!-- conditional list to show artist link either collection or by searh -->
      {% capture series %}{{my_meta.series | handle}}{%endcapture%}
      {%if collections[series].products.size != 0 %}
      <a href="/collections/{{my_meta.series | handle }}" class="text-gray-800 no-underline">
        <li class="flex items-baseline justify-between gap-1 text-base empty:hidden ">{{card_product.metafields.my_fields.series | truncate:15}}
          <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
            <path stroke-linecap="round" stroke-linejoin="round" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14" />
          </svg>
        </li>
      </a>
      {%elsif my_meta.series %}
      <a href="/search?q={{my_meta.series | handle }}" class="no-underline">
        <li class="flex items-baseline justify-between gap-1 text-base empty:hidden ">
          {{card_product.metafields.my_fields.series | truncate:15}}
          <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
            <path stroke-linecap="round" stroke-linejoin="round" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14" />
          </svg>
        </li>
      </a>
      {%endif%}

      <!-- conditional list to show item type link either collection or by searh -->
      {% capture type %}{{my_meta.item_type | handle}}{%endcapture%}
      {%if collections[type].products.size != 0 %}
      <a href="/collections/{{type}}" class="text-gray-800 no-underline">
        <li class="flex items-baseline justify-between gap-1 text-base empty:hidden ">{{card_product.metafields.my_fields.item_type | truncate:15}}
          <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
            <path stroke-linecap="round" stroke-linejoin="round" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14" />
          </svg>
        </li>
      </a>
      {%elsif my_meta.item_type %}
      <a href="/search?q={{my_meta.item_type }}" class="no-underline">
        <li class="flex items-baseline justify-between gap-1 text-base empty:hidden ">
          {{card_product.metafields.my_fields.item_type | truncate:15}}
          <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
            <path stroke-linecap="round" stroke-linejoin="round" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14" />
          </svg>
        </li>
      </a>
      {%endif%}
      
      <!-- conditional list to show product line link either collection or by searh -->
      {% capture lines %}{{my_meta.product_lines | handle}}{%endcapture%}
      {%if collections[lines].products.size != 0 %}
      <a href="/collections/{{lines}}" class="text-gray-800 no-underline">
        <li class="flex items-baseline justify-between gap-1 text-base empty:hidden ">{{card_product.metafields.my_fields.product_lines | truncate:15}}
          <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
            <path stroke-linecap="round" stroke-linejoin="round" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14" />
          </svg>
        </li>
      </a>
      {%elsif my_meta.product_lines %}
      <a href="/search?q={{my_meta.product_lines }}" class="no-underline">
        <li class="flex items-baseline justify-between gap-1 text-base empty:hidden ">
          {{card_product.metafields.my_fields.product_lines | truncate:15}}
          <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
            <path stroke-linecap="round" stroke-linejoin="round" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14" />
          </svg>
        </li>
      </a>
      {%endif%}

      <!-- conditional list to show brand link either collection or by searh -->
      {% capture brand %}{{my_meta.brand | handle}}{%endcapture%}
      {%if collections[brand].products.size != 0 %}
      <a href="/collections/{{brand}}" class="flex-initial text-gray-800 no-underline">
        <li class="flex items-baseline justify-between gap-1 text-base empty:hidden shrink">{{card_product.metafields.my_fields.brand | truncate:15}}
          <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
            <path stroke-linecap="round" stroke-linejoin="round" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14" />
          </svg>
        </li>
      </a>
      {%elsif my_meta.brand %}
      <a href="/search?q={{my_meta.brand }}" class="flex-initial no-underline">
        <li class="flex items-baseline justify-between gap-1 text-base break-words empty:hidden">
          {{card_product.metafields.my_fields.brand | truncate:15}}
          <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
            <path stroke-linecap="round" stroke-linejoin="round" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14" />
          </svg>
        </li>
      </a>
      {%endif%}

      <!-- conditional list to show grade link either collection or by searh -->
      {% capture grade %}{{my_meta.grade | handle}}{%endcapture%}
      {%if collections[grade].products.size != 0 %}
      <a href="/collections/{{grade}}" class="text-gray-800 no-underline">
        <li class="flex items-baseline justify-between gap-1 text-base empty:hidden shrink">{{card_product.metafields.my_fields.grade | truncate:15}}
          <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
            <path stroke-linecap="round" stroke-linejoin="round" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14" />
          </svg>
        </li>
      </a>
      {%elsif my_meta.grade %}
      <a href="/search?q={{my_meta.grade }}" class="no-underline">
        <li class="flex items-baseline justify-between gap-1 text-base empty:hidden ">
          {{card_product.metafields.my_fields.grade | truncate:15}}
          <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
            <path stroke-linecap="round" stroke-linejoin="round" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14" />
          </svg>
        </li>
      </a>
      {%endif%}
    </ul>
    
  </div>
  
  <!-- badge labels  -->
  <div class="absolute flex gap-x-2 -top-3 right-1 ">
    
    {%if card_product.tags contains 'new' %}
      <div class="flex items-center justify-center px-1 text-sm text-white rounded-md shadow-lg h-7 bg-emerald-500">New</div>
    {%endif%}
    {%if card_product.compare_at_price > card_product.price %}
      <div class="flex items-center justify-center px-1 text-sm text-white bg-pink-500 rounded-md shadow-lg h-7">Sale</div>
    {%endif%}
    {%- if card_product.available == false -%}
      <span class="flex items-center justify-center px-1 text-sm text-white bg-gray-500 rounded-md shadow-lg h-7">Soldout</span>
    {%endif%}
    {%- if card_product.variants.first.inventory_quantity == 1 -%}
      <span class="flex items-center justify-center px-1 text-base text-gray-100 bg-orange-500 rounded-md shadow-lg h-7">1 Left</span>
    {%endif%} 
    {% if card_product.metafields.ssw.review.count > '0' %}
      <div class="flex items-center justify-center px-1 bg-purple-100 rounded-md shadow-lg outline-purple-400 outline h-7 ">
        <svg xmlns="http://www.w3.org/2000/svg" class="text-purple-500 w-7 h-7" viewBox="0 0 20 20" fill="currentColor">
          <path d="M2 10.5a1.5 1.5 0 113 0v6a1.5 1.5 0 01-3 0v-6zM6 10.333v5.43a2 2 0 001.106 1.79l.05.025A4 4 0 008.943 18h5.416a2 2 0 001.962-1.608l1.2-6A2 2 0 0015.56 8H12V4a2 2 0 00-2-2 1 1 0 00-1 1v.667a4 4 0 01-.8 2.4L6.8 7.933a4 4 0 00-.8 2.4z" />
        </svg>
        <!-- <span class="text-base text-neutral-700">Review</span> -->
      </div>
    {%endif%} 
  </div>

<!-- growave wishlist button  -->
  <div class="absolute bottom-12 left-1 w-[5rem]">
    {% capture the_snippet_fave_icon %}{% render 'ssw-widget-faveicon' with card_product.id %}{% endcapture %}
  {% unless the_snippet_fave_icon contains 'Liquid error' %}
       {{ the_snippet_fave_icon }}
  {% endunless %}
  </div>
</div>
<!-- * commented out for later use 
  <div class="relative w-full overflow-hidden rounded-b-lg grid grid-cols-3 grid-rows-5 bg-transparent {%if card_product.type == 'Kpop CD'%} h-[35rem]{%else%} h-[37rem]{%endif%}">
  <div class="absolute w-[90%] left-[5%] h-full overflow-hidden text-center bg-white shadow-lg rounded-t-lg hover:scale-110 transform duration-200">
    {%if card_product.featured_media.aspect_ratio < 1 %}
    <img src="{{card_product.featured_media |img_url:'x350'}}" alt="" class="object-cover h-full ">
    {%elsif card_product.featured_media.aspect_ratio > 1.2 %}
    <img src="{{card_product.featured_media |img_url:'x350'}}" alt="" class="object-cover object-center max-h-[20rem] pt-[4rem]">
    {%else%}
    <img src="{{card_product.featured_media |img_url:'x350'}}" alt="" class="object-cover object-center w-full max-h-2/3">
    {%endif%}
  </div>
  <div class="absolute -bottom-[2rem] bg-slate-500 transform -skew-y-[5deg] h-[15rem] w-full shadow-lg">
  </div>
  <div class="relative flex flex-col items-center justify-center row-start-5 px-4 col-span-full">
    <div class="text-xl text-center text-gray-200 bg-clip-text">{{card_product.title | escape}}-{{card_product.featured_media.aspect_ratio}}</div>
  </div>
  <div class="relative flex items-center justify-center col-span-2 col-start-2 row-span-1 row-start-4 ">
    <div class="px-4 py-2 bg-amber-100 rounded-xl">{% render 'price', product: card_product, price_class: 'text-center' %}</div>
  </div>
</div> -->


{%comment%}
{%- if card_product and card_product != empty -%}
<div class="relative flex flex-col items-center justify-center h-[37rem] bg-gradient-to-b from-white via-white to-slate-300 overflow-hidden rounded-xl">
    {%if card_product.featured_media.aspect_ratio < 0.9 %}
    <div class="flex flex-col flex-shrink-0 w-full h-full">
      <img src="{{card_product.featured_media | img_url:'x350'}}" class="object-cover max-w-full h-[37rem]" alt="">
    </div>
    {%elsif card_product.featured_media.aspect_ratio > 1.2 %}
    <div class="flex flex-col items-center justify-center pb-[15rem] flex-shrink-0 w-full h-full ">
      <img src="{{card_product.featured_media | img_url:'350x'}}" class="object-cover w-[95%] " alt="">
    </div>
    {%else%}
    <div class="flex flex-col items-center flex-shrink-0 w-full h-full pb-[10rem]">
      <img src="{{card_product.featured_media | img_url:'350x'}}" class="object-cover w-[95%] " alt="">
    </div>
    {%endif%}
    <div class="absolute bottom-[1rem] w-5/6 h-[12rem] p-6 mx-auto text-xl  hover:bg-opacity-80 bg-white bg-opacity-60 backdrop-filter backdrop-blur-lg rounded-xl">
      {{card_product.title}} - {{card_product.featured_media.aspect_ratio}}
    </div>
</div>
{% endif %}              
{%endcomment%}